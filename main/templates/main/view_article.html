{% extends 'base.html' %} {% block content %}
{% load static %}
{% load crispy_forms_tags %}
<div class="container">
    <img src="{% static 'images/placeholder.jpeg' %}" class="img-fluid" alt="...">
</div>
  <div class="container">
      <div class="row">
              <h1 class="post-title text-center">{{ article.title }}</h1>
      </div>
      <div class="row">
            <p class="text-center pt-3">{{article.article_author}} | {{ article.created_on }}</p>
    </div>
  </div>
<div class="container">
  <div class="row">
      <div class="col card mb-4  mt-3 left top">
          <div class="card-body">
              <p class="card-text">
                  {{ article.content | safe }}
              </p>
          </div>
      </div>
  </div>
</div>

<!-- Comments Section -->

<div class="container">
    <div class="row">
        <div class="col-lg-8">
            {% for comment in comments %}
            <div class="d-flex flex-column mb-4 p-3 comment-container {% if not comment.approved and comment.comment_author == user %}text-muted{% elif not comment.approved %}d-none{% endif %}">
                <div class="d-flex justify-content-between">
                    <div>
                        <p class="author">@{{ comment.comment_author }}</p>
                    </div>
                    <div class="ml-auto">
                        <p class="likes px-2"><i class="fa-regular fa-heart m-1"></i>25</p>
                    </div>
                </div>
                <div>
                    <p><small class="text-muted">{{ comment.created_on }}</small></p>
                </div>
                <div>
                    <p>{{ comment.body | safe }}</p>
                </div>
                {% if not comment.approved and comment.comment_author == user %}
                <p class="approval">
                    This comment is awaiting approval
                </p>
                {% endif %}
                {% if user.is_authenticated and comment.comment_author == user %}
                <button class="btn edit-btn" comment_id="{{ comment.id }}">Edit</button>
                {% endif %}
            </div>
            {% endfor %}
        </div>

        <!-- Submit a comment -->
        <div class="col-lg-4">
            <p>
                <button class="btn leave-comment-btn" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                  Leave a comment
                </button>
              </p>
              <div class="collapse" id="collapseExample">
                <div class="card card-body">
                    <div class="card-body">
                        {% if user.is_authenticated %}
                        <h2>Leave a comment:</h2>
                        <p>Posting as: {{ user.username }}</p>
                        <form id="commentForm" method="post">
                            {{ comment_form | crispy }}
                            {% csrf_token %}
                            <button id="submitButton" type="submit"
                              class="btn article-btn btn-lg">Submit</button>
                          </form>
                          {% else %}
                          <p>If you wish to leave a comment, please
                            <a href="{% url 'account_login' %}" class="log-in-link">log in</a> or
                            <a href="{% url 'register' %}" class="register-link">sign up</a>
                          </p>
                          {% endif %}
                    </div>
                </div>
              </div>
        </div>
    </div>
</div>
{% endblock content %}